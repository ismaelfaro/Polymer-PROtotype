<script>

    (function() {

      var _appData =
        {
          developer: true,
          appName: 'filter.ly',
          logo: 'images/logo.png',
          defaultLang: 'en',
          serverName: 'polymer-prototype',
					APIUrl: {
										'prod': 'http://prod.filter.ly/',
										'qa': 'http://qa.filter.ly/',
										'dev': 'http://127.0.0.1:3000/'
									},
					API: {
										'authnative': this.urlBase + 'api/1/user/authnative',
										'register': this.urlBase + 'api/1/user/register',
										'resetPwd': this.urlBase + 'TODO:',
										'readNews': this.urlBase + 'TODO:',
										'readProfile': this.urlBase + 'TODO:',
										'addUrl': this.urlBase + 'TODO:',
									},
					urlBase: '',

        };

			var _dataStorage = {};

			var _appLocation = _APPLocation;

      var _userProfile = { auth: false };

      Polymer({
        is: 'app-config',
        properties: {
          app: {
            type: Object,
            notify: true,
            value: function() { return _appData; }
					},
					locale: {
            type: Object,
            notify: true,
            value: function() {
                _appLocation.setLanguage(_appLocation.getDeviceLanguage());
                return _appLocation; },
          },
          location: {
            type: Object,
            notify: true,
            value: function() {
                return _appLocation.location; },
          },
					data: {
						type: Object,
						notify: true,
						value: function() { return _dataStorage; },
					},
          userProfile: {
            type: Object,
            notify: true,
            value: function() { return _userProfile; },
          }
        },
        consoldev: function(text){
          if(this.app.developer){
            console.info(text);
          }
        },
        _bake_cookie:function (data) {
          return 'APP='+JSON.stringify(data);
          // return JSON.stringify(data);

        },
        _recover_cookie: function(data){
          // var result = document.cookie.match(new RegExp('APP=([^;]+)'));
          // result && (result = JSON.parse(result[1]));
          return JSON.parse(data.split('APP=')[1]);
          // return JSON.parse(data);
        },
        loadCookie: function(){

          if (document.cookie === '' || document.cookie === 'APP=') return undefined
          else {
            this.userProfile = this._recover_cookie(document.cookie);
            return this.userProfile;
          }

        },
        saveCookie: function(){
          document.cookie = this._bake_cookie(this.userProfile);
          console.log('saveCookie:');
          console.info( this.userProfile );
        },
        removeCookie: function(){
          document.cookie = 'APP=';
        }
      });
    })();

</script>
