<link rel="import" href="../app-config-behavior.html">

<dom-module id="page-login">
	<template>
		<style>
			:host {
				display: block;
			}

			app-logo-screen {
				padding: 32px;
			}

			#base-footer {
				position: absolute;
				left: 0px;
				right: 0px;
				bottom: 0px;
				padding: 32px;
			}

			#base-footer > .buttons {
				margin-top: 16px;
			}

			paper-input {
				--paper-input-container-color: white;
				--paper-input-container-focus-color: yellow;
				--paper-input-container-invalid-color: orange;
				--paper-input-container-input-color: white;
				width: 100%;
			}

			paper-button {
				font-weight: 100;
				color: white;
				background-color: rgba(255, 255, 255, 0.2);
				width: 100%;
				text-transform: none;
			}
		</style>

		<iron-ajax id="ajax" url="" method="post" handle-as="json" on-response="hresponse" debounce-duration="300"></iron-ajax>

		<app-logo-screen title="{{config.location.tittleLogin}}" logo="images/logo-app.png"></app-logo-screen>

		<div id="base-footer">

			<app-social-buttons></app-social-buttons>

			<div class="horizontal center-justified layout">
				<paper-input id="email" label="{{config.location.email}}" value="{{user.email}}"></paper-input>
			</div>

			<div class="horizontal center-justified layout">
				<paper-input id="pwd" label="{{config.location.password}}" type="password" value="{{user.pwd}}"></paper-input>
			</div>

			<div class="horizontal center-justified layout buttons">
				<paper-button on-tap="login">{{config.location.login}}</paper-button>
				<paper-button on-tap="register">{{config.location.register}}</paper-button>
			</div>

			<app-footer-buttons page="{{page}}" config="{{config}}"></app-footer-buttons>

			</div>

	</template>
</dom-module>

<script>
	Polymer({
		is: 'page-login',
		behaviors: [appConfig],
		properties: {
			page: {
				type: String,
				notify: true
			}
		},
		login: function () {
			console.info(this.config);
			this.$.ajax.url = this.config.API['authnative'];
			this.$.ajax.body = {
				email: this.userEmail,
				pwd: this.pwd,
				pwd2: null,
				timezone: 'Europe/Berlin',
				fromSignup: false
			};

			this.$.ajax.generateRequest();
		},
		hresponse: function (demo) {
//			console.log(demo);
			//TODO: check user and update login to true
		},
		register: function () {
			this.page = 'register';
		},
		ready: function() {

		},

	});
</script>
