<link rel="import" href="../styles/app-theme.html">
<link rel="import" href="layout/app-toolbar.html">
<link rel="import" href="app-config.html">

<dom-module id="app-filterly-login">

	<link rel="import" type="css" href="app-filterly.css">

	<style>
		:host {
			display: block;
			height: 100%;
		}
		
		iron-pages {
			
			height: 100%;
		}
		
		#page{
			background-image: url(../images/flower.jpg);
			background-size: cover;
			color: var(--text-primary-color);
			
		}
		
	</style>

	<template>

		<app-config id="config" server-mode="{{serverMode}}" config="{{configuration}}"></app-config>

		<template id="loginpages" is="dom-if" if="{{!loginUser}}">

			<iron-pages id="page" attr-for-selected="data-route" selected="{{route}}">
			
				<section data-route="login">
					<page-login config="{{configuration}}"></page-login>
				</section>

				<section data-route="register">
					register
					<page-register config="{{configuration}}"></page-register>
				</section>

				<section data-route="resetpassword">
					reset password
					<page-resetpassword config="{{configuration}}"></page-resetpassword>
				</section>

			</iron-pages>

		</template>

		<template is="dom-if" if="{{loginUser}}">

			<paper-drawer-panel id="paperDrawerPanel" right-drawer>
				<div drawer>
					<!-- Drawer Toolbar -->
					<paper-toolbar id="drawerToolbar">
						<span class="paper-font-title">Menu</span>
					</paper-toolbar>

					<!-- Drawer Content -->
					<paper-menu class="list" attr-for-selected="data-route" selected="{{route}}" on-iron-select="onMenuSelect">
						<a data-route="news" href="/news">
							<iron-icon icon="view-list"></iron-icon>
							<span>News</span>
						</a>

						<a data-route="categories" href="/categories">
							<iron-icon icon="dashboard"></iron-icon>
							<span>Categories</span>
						</a>

						<a data-route="profile" href="/profile">
							<iron-icon icon="face"></iron-icon>
							<span>Profile</span>
						</a>


					</paper-menu>
				</div>
				<paper-header-panel main mode="waterfall">

					<!-- Main Toolbar -->

					<!--       	<app-toolbar id="mainToolbar"></app-toolbar>-->

					<paper-toolbar id="mainToolbar">


						<div id="logo" class="paper-font-display2 app-name">

							<iron-image style="background-position-x: 100%;width:50%; height:50%; padding-top: 50px; margin-top: 8px;" sizing="cover" src="{{configuration.logo}}"></iron-image>

						</div>

						<span class="flex"></span>

						<paper-icon-button id="paperToggle" class="menu-button" icon="menu" paper-drawer-toggle> </paper-icon-button>
					</paper-toolbar>

					<!-- Main Content -->
					<div class="content">
						<iron-pages id="pageBase" attr-for-selected="data-route" selected="{{route}}">
							
							<section data-route="news">
								<page-news></page-news>
							</section>

							<section data-route="categories">
								<paper-material elevation="1">
									<h2 class="paper-font-display2">Categories</h2>

									<categorie-table></categorie-table>

								</paper-material>
							</section>

							<section data-route="profile">
								<paper-material elevation="1">
									<h2 class="paper-font-display2">Contact</h2>
									<page-profile user='{"name":"pepe","mail":"my@email.com","image":"/images/db/3.jpg"}' </page-profile>
										<google-map></google-map>
								</paper-material>
							</section>

						</iron-pages>
					</div>
				</paper-header-panel>
			</paper-drawer-panel>


		</template>


		<paper-toast id="caching-complete" duration="6000" text="Caching complete! This app will work offline.">
		</paper-toast>

		<platinum-sw-register auto-register clients-claim skip-waiting on-service-worker-installed="displayInstalledToast">
			<platinum-sw-cache default-cache-strategy="networkFirst" precache-file="precache.json">
			</platinum-sw-cache>
		</platinum-sw-register>

	</template>
</dom-module>

<script>
	Polymer({
		is: 'app-filterly-login',
		properties: {
			loginUser: {
				type: Boolean,
				value: true
			},
			configuration: {
				type: Object,
				notify: true,
				observer: "dale"
			},
		},
		onMenuSelect: function () {
			if (this.$.paperDrawerPanel.narrow) {
				this.$.paperDrawerPanel.closeDrawer();
			}
		},
		_openMenu: function () {
			this.$.paperDrawerPanel.openDrawer();
		},
		ready: function () {
			
			if(this.loginUser){
				 window.location.href="/#!/news";
			}
			
//			if(this.loginUser){
//				this.route = 1;
//			} else {
//				this.route = 0;
//			}
//			
			this.serverMode = 'prod';
			console.log('loginUser:' + this.loginUser);
		},
		dale: function (demodemo) {
			console.log('-----');
			console.info(demodemo);
		}
	});
</script>